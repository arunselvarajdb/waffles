# MCP Gateway - Default Configuration
# All values can be overridden with environment variables

server:
  host: 0.0.0.0
  port: 8080
  read_timeout: 30s
  write_timeout: 30s
  shutdown_timeout: 10s
  environment: development

database:
  host: localhost
  port: 5432
  user: postgres
  password: postgres
  database: mcp_gateway
  max_open_conns: 25
  max_idle_conns: 5
  conn_max_lifetime: 5m
  conn_max_idle_time: 1m

redis:
  host: localhost
  port: 6379
  password: ""
  db: 0

auth:
  enabled: true # Set to true in production to require login
  session_secret: dev-session-secret-change-in-production-32b
  session_max_age: 24h
  cookie_secure: false # Set to true in production (HTTPS only)
  cookie_same_site: lax
  jwt_secret: change-this-in-production
  jwt_access_token_expiry: 15m
  jwt_refresh_token_expiry: 168h # 7 days
  # Resource RBAC - when enabled, users only see servers in namespaces their role has access to
  # When disabled (default), all authenticated users see all servers
  resource_rbac_enabled: true

  # MCP Client Authentication
  # Controls which auth methods are accepted for MCP clients (Claude Code, etc.)
  mcp_auth:
    api_key: true    # Accept API keys (Authorization: Bearer mcpgw_xxx)
    session: true    # Accept session cookies from browser
    oauth: true      # Enable OAuth for MCP clients (DCR flow)
                     # Set to false to require API keys even when UI SSO is enabled

  # SSO/OIDC Configuration
  # Recommended: Keycloak (supports DCR for MCP clients like Claude Code)
  # Also works with: Zitadel, Okta, Auth0, Azure AD, Google
  # Note: For MCP clients to use OAuth, your IdP must support Dynamic Client Registration (DCR)
  oauth:
    enabled: false # Set to true to enable SSO login
    base_url: http://localhost:8080 # Base URL for SSO callbacks (your MCP Gateway URL)
    default_role: viewer # Default role for new SSO users
    auto_create_users: true # Create users on first SSO login

    # OIDC Provider Configuration
    # Set redirect URI in your provider to: {base_url}/api/v1/auth/sso/callback
    #
    # Example issuer URLs for common providers:
    #   Keycloak:   http://localhost:8180/realms/mcp-gateway (local dev)
    #               https://auth.example.com/realms/mcp-gateway (production)
    #   Zitadel:    https://auth.example.com
    #   Okta:       https://mycompany.okta.com/oauth2/default
    #   Auth0:      https://mycompany.auth0.com/
    #   Azure AD:   https://login.microsoftonline.com/{tenant-id}/v2.0
    #   Google:     https://accounts.google.com
    #
    issuer: "" # OIDC issuer URL (provider's .well-known/openid-configuration endpoint base)
    client_id: "" # OAuth client ID from your provider
    client_secret: "" # OAuth client secret from your provider
    scopes: # OIDC scopes to request
      - openid
      - email
      - profile
    allowed_domains: [] # Optional: restrict to specific email domains, e.g., ["example.com"]

secrets:
  provider: env # Use 'env' for local dev, 'aws' for production
  aws:
    region: us-east-1
    secret_prefix: mcp-gateway

logging:
  level: info # debug, info, warn, error
  format: json # json or console

metrics:
  enabled: true
  prometheus_port: 9090

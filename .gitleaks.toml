# Gitleaks configuration
# https://github.com/gitleaks/gitleaks

title = "MCP Gateway Gitleaks Config"

[extend]
# Use default rules as base
useDefault = true

# Allowlist patterns for false positives
[allowlist]
description = "Allowlisted patterns"

# Example/placeholder values
regexes = [
  '''your-api-key''',
  '''your-key''',
  '''your-super-secret''',
  '''changeme''',
  '''placeholder''',
  '''example''',
  '''testuser123''',
  '''testadmin123''',
  '''waffles-secret''',  # Example Keycloak secret
]

# Allowlisted paths
paths = [
  '''\.env\.example$''',
  '''docs/.*\.md$''',
  '''test/.*''',
  '''.*_test\.go$''',
  '''examples/oauth/keycloak/waffles-realm\.json$''',  # Test realm config
]

# Custom rules
[[rules]]
id = "hardcoded-password-assignment"
description = "Hardcoded password in code"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*[\"'][^\"']{8,}[\"']'''
secretGroup = 0
entropy = 3.5
keywords = ["password", "passwd", "pwd"]

[[rules]]
id = "hardcoded-api-key"
description = "Hardcoded API key in code"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*[\"'][a-zA-Z0-9_\-]{16,}[\"']'''
secretGroup = 0
entropy = 3.5
keywords = ["api_key", "apikey", "api-key"]

[[rules]]
id = "jwt-secret"
description = "Potential JWT secret"
regex = '''(?i)jwt[_-]?secret\s*[:=]\s*[\"'][^\"']{16,}[\"']'''
secretGroup = 0
entropy = 3.5
keywords = ["jwt_secret", "jwt-secret", "jwtsecret"]

[[rules]]
id = "generic-secret"
description = "Generic secret pattern"
regex = '''(?i)(secret|token|key|password|credential)[\"']?\s*[:=]\s*[\"']([a-zA-Z0-9+/=_\-]{20,})[\"']'''
secretGroup = 2
entropy = 3.5
keywords = ["secret", "token", "key", "password", "credential"]
